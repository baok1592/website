(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b73b430"],{"078c":function(t,e,i){var a=i("0b34"),o=i("76e3"),n=i("3d8a"),s=i("1a58"),l=i("bb8b").f;t.exports=function(t){var e=o.Symbol||(o.Symbol=n?{}:a.Symbol||{});"_"==t.charAt(0)||t in e||l(e,t,{value:s.f(t)})}},"085b":function(t,e,i){"use strict";var a=i("e99b"),o=i("52a4")(!1),n=[].indexOf,s=!!n&&1/[1].indexOf(1,-0)<0;a(a.P+a.F*(s||!i("95b6")(n)),"Array",{indexOf:function(t){return s?n.apply(this,arguments)||0:o(this,t,arguments[1])}})},"1a58":function(t,e,i){e.f=i("839a")},"21d9":function(t,e,i){var a=i("3a4c"),o=i("065e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return a(t,o)}},"30a7":function(t,e,i){"use strict";i("4583")},3441:function(t,e,i){"use strict";var a=i("e99b"),o=i("3250"),n=i("8078"),s=i("0926"),l=[].sort,r=[1,2,3];a(a.P+a.F*(s((function(){r.sort(void 0)}))||!s((function(){r.sort(null)}))||!i("95b6")(l)),"Array",{sort:function(t){return void 0===t?l.call(n(this)):l.call(n(this),o(t))}})},3733:function(t,e,i){},"37a6":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"category"}},[i("el-container",[i("el-aside",{attrs:{width:"200px"}},[i("NavTo")],1),i("el-container",[i("el-header",{staticStyle:{"border-bottom":"1px solid #d0d0d0"}},[i("Header")],1),i("el-main",[i("transition",{attrs:{appear:"","appear-active-class":"animated fadeInLeft"}},[i("div",{staticClass:"category"},[1==t.is_add?i("el-row",[0==t.is_hsz?i("el-button",{staticClass:"btn",attrs:{type:"primary",size:"small"},on:{click:t.add}},[t._v(t._s(t.btn_name))]):t._e(),0==t.is_hsz?i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.hsz}},[t._v("回收站")]):t._e(),1==t.is_hsz?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.is_hsz=0}}},[t._v("返回")]):t._e()],1):t._e(),1==t.is_hsz?i("el-row",{staticStyle:{"margin-bottom":"20px","margin-top":"10px"}},[i("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.pl_del}},[t._v("批量删除")]),i("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.pl_hf}},[t._v("批量恢复")])],1):t._e(),i("el-dialog",{attrs:{title:"",visible:t.editbox,width:"35%",center:""},on:{"update:visible":function(e){t.editbox=e}}},[i("el-form",{attrs:{model:t.editform}},[i("el-form-item",{staticStyle:{width:"80%"},attrs:{label:"栏目名称","label-width":t.formLabelWidth}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:t.editform.category_name,callback:function(e){t.$set(t.editform,"category_name",e)},expression:"editform.category_name"}})],1),i("el-form-item",{staticStyle:{width:"80%"},attrs:{label:"栏目简称","label-width":t.formLabelWidth}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:t.editform.short_name,callback:function(e){t.$set(t.editform,"short_name",e)},expression:"editform.short_name"}})],1),i("el-form-item",{attrs:{label:"上级栏目","label-width":t.formLabelWidth}},[i("el-select",{attrs:{placeholder:"请选择分类"},model:{value:t.editform.pid,callback:function(e){t.$set(t.editform,"pid",e)},expression:"editform.pid"}},[i("el-option",{attrs:{label:"顶级分类",value:"0"}}),t._l(t.category_top,(function(t,e){return i("el-option",{key:e,attrs:{value:t.category_id,label:t.category_name}})}))],2)],1)],1),i("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.editbox=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit(t.editindex)}}},[t._v("确 定")])],1)],1),1==t.is_add&&0==t.is_hsz?[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,border:""}},[i("el-table-column",{attrs:{prop:"",label:"排序",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input",{model:{value:e.row.sort,callback:function(i){t.$set(e.row,"sort",i)},expression:"scope.row.sort"}})]}}],null,!1,900905939)}),i("el-table-column",{attrs:{prop:"category_name",label:"栏目名字",width:"280"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.line?i("span",[t._v("  |——")]):t._e(),t._v(t._s(e.row.category_name)+"\n\t\t\t\t\t\t\t\t\t")]}}],null,!1,194114774)}),i("el-table-column",{attrs:{prop:"short_name",label:"栏目简称",width:"180"}}),i("el-table-column",{attrs:{prop:"pid",label:"Pid",width:"150"}}),i("el-table-column",{attrs:{prop:"is_visible",label:"是否显示",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#DCDFE6","active-value":1,"inactive-value":0},on:{change:function(i){return t.onswitch(e.row.category_id)}},model:{value:e.row.is_visible,callback:function(i){t.$set(e.row,"is_visible",i)},expression:"scope.row.is_visible"}})]}}],null,!1,619593615)}),i("el-table-column",{attrs:{prop:"is_visible",label:"推荐到PC首页",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#DCDFE6","active-value":1,"inactive-value":0},on:{change:function(i){return t.onindex(e.row.category_id,"pc")}},model:{value:e.row.is_pc_index,callback:function(i){t.$set(e.row,"is_pc_index",i)},expression:"scope.row.is_pc_index"}})]}}],null,!1,2648122560)}),i("el-table-column",{attrs:{prop:"is_visible",label:"推荐到手机首页",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#DCDFE6","active-value":1,"inactive-value":0},on:{change:function(i){return t.onindex(e.row.category_id,"ph")}},model:{value:e.row.is_phone_index,callback:function(i){t.$set(e.row,"is_phone_index",i)},expression:"scope.row.is_phone_index"}})]}}],null,!1,2138538980)}),i("el-table-column",{attrs:{prop:"level",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"success",size:"small"},on:{click:function(i){return t.onedit(e.row)}}},[t._v("修改")]),i("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(i){return t.del(e.row.category_id,e.$index)}}},[t._v("删除")])]}}],null,!1,3516355377)})],1),i("div",{staticClass:"sort_btn"},[i("el-button",{attrs:{type:"success",size:"small"},on:{click:t.sort_sub}},[t._v("提交排序")])],1)]:t._e(),1==t.is_hsz?[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.hsz_list,border:"","tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"45"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("input",{staticStyle:{zoom:"180%","text-align":"center"},attrs:{type:"checkbox"},on:{change:function(i){return t.choose(e.row.category_id)}}})]}}],null,!1,3719593838)}),i("el-table-column",{attrs:{prop:"category_name",label:"栏目名字",width:"280"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.line?i("span",[t._v("  |——")]):t._e(),t._v(t._s(e.row.category_name)+"\n\t\t\t\t\t\t\t\t\t")]}}],null,!1,194114774)}),i("el-table-column",{attrs:{prop:"short_name",label:"栏目简称",width:"180"}}),i("el-table-column",{attrs:{prop:"pid",label:"Pid",width:"150"}}),i("el-table-column",{attrs:{prop:"is_visible",label:"是否显示",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#DCDFE6","active-value":1,"inactive-value":0},on:{change:function(i){return t.onswitch(e.row.category_id)}},model:{value:e.row.is_visible,callback:function(i){t.$set(e.row,"is_visible",i)},expression:"scope.row.is_visible"}})]}}],null,!1,619593615)}),i("el-table-column",{attrs:{prop:"is_visible",label:"推荐到首页",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#DCDFE6","active-value":1,"inactive-value":0},on:{change:function(i){return t.onindex(e.row.category_id)}},model:{value:e.row.is_index,callback:function(i){t.$set(e.row,"is_index",i)},expression:"scope.row.is_index"}})]}}],null,!1,66549971)})],1)]:t._e(),2==t.is_add?[i("el-row",[i("el-button",{staticClass:"btn",attrs:{type:"primary",size:"small"},on:{click:t.back}},[t._v("返回")])],1),i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px"}},[i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"常规选项",name:"first"}},[i("el-row",[i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"栏目名称"}},[i("el-input",{staticStyle:{width:"80%"},model:{value:t.form.category_name,callback:function(e){t.$set(t.form,"category_name",e)},expression:"form.category_name"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"栏目简称"}},[i("el-input",{staticStyle:{width:"20%"},model:{value:t.form.short_name,callback:function(e){t.$set(t.form,"short_name",e)},expression:"form.short_name"}})],1)],1),i("el-col",{attrs:{span:8}})],1),i("el-row",[i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"上级栏目"}},[i("el-select",{attrs:{placeholder:"请选择上级分类"},model:{value:t.form.pid,callback:function(e){t.$set(t.form,"pid",e)},expression:"form.pid"}},[i("el-option",{attrs:{label:"顶级栏目",value:"0"}}),t._l(t.article_leve_h,(function(t){return i("el-option",{attrs:{label:t.category_name,value:t.category_id}})}))],2)],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-row",[i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"栏目类型"}},[i("el-select",{attrs:{placeholder:"请选择分类模板"},on:{change:function(e){return t.choose_json(t.form.type)}},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[i("el-option",{attrs:{label:"封面",value:"cover"}}),i("el-option",{attrs:{label:"文章列表",value:"article_list"}}),i("el-option",{attrs:{label:"图片列表",value:"pic_list"}}),i("el-option",{attrs:{label:"外部链接",value:"address"}})],1)],1)],1),"address"==t.form.type?i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"跳转到"}},[i("el-input",{model:{value:t.form.jumpaddress,callback:function(e){t.$set(t.form,"jumpaddress",e)},expression:"form.jumpaddress"}})],1)],1):t._e()],1)],1)],1),i("el-form-item",{attrs:{label:"分类图片"}},[t.img_list.length>0?[i("div",{staticStyle:{display:"flex",width:"530px","flex-wrap":"wrap"}},[t._l(t.img_list,(function(e,a){return[i("i",{staticClass:"el-icon-circle-close",on:{click:function(e){return t.delimg(a)}}}),t.img_list.length>0?i("div",{staticClass:"picA"},[i("img",{staticClass:"img",attrs:{src:t.getimg+e.url}})]):t._e()]}))],2)]:t._e(),t.img_list.length<1?i("div",{staticClass:"picA",staticStyle:{"margin-left":"19px"},on:{click:t.to_choose_img}},[i("i",{staticClass:"el-icon-plus",staticStyle:{"margin-top":"45%",height:"28px",width:"28px"}})]):t._e()],2),"cover"==t.form.type?i("el-form-item",{attrs:{label:"文章内容","label-width":t.formLabelWidth}},[i("vue-ueditor-wrap",{attrs:{config:t.myConfig},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1):t._e()],1),i("el-tab-pane",{attrs:{label:"高级选项",name:"second"}},[i("el-row",[i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"SEO标题"}},[i("el-input",{model:{value:t.form.seotitle,callback:function(e){t.$set(t.form,"seotitle",e)},expression:"form.seotitle"}})],1)],1),i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"关键词"}},[i("el-input",{model:{value:t.form.keyword,callback:function(e){t.$set(t.form,"keyword",e)},expression:"form.keyword"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"栏目描述"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2}},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1)],1),t.cate_json.cover?i("div",[t.cate_json.cover["flag"]||t.cate_json.article_list["flag"]||t.cate_json.pic_list["flag"]?i("el-row",[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"JSON"}},[i("ul",{staticClass:"json"},[t.cate_json.cover["flag"]?t._l(t.cate_json.cover.data.length,(function(e){return i("li",[i("span",[t._v(t._s(e-1))]),i("el-input",{attrs:{type:"textarea",autosize:{minRows:2}},on:{input:function(i){return t.changeCateJsonCover(e-1,i)}},model:{value:t.cate_json.cover.data[e-1],callback:function(i){t.$set(t.cate_json.cover.data,e-1,i)},expression:"cate_json.cover.data[i - 1]"}})],1)})):t._e(),t.cate_json.article_list["flag"]?t._l(t.cate_json.article_list.data.length,(function(e){return i("li",[i("span",[t._v(t._s(e-1))]),i("el-input",{attrs:{type:"textarea",autosize:{minRows:2}},on:{input:function(i){return t.changeCateJsonArticle(e-1,i)}},model:{value:t.cate_json.article_list.data[e-1],callback:function(i){t.$set(t.cate_json.article_list.data,e-1,i)},expression:"cate_json.article_list.data[i - 1]"}})],1)})):t._e(),t.cate_json.pic_list["flag"]?t._l(t.cate_json.pic_list.data.length,(function(e){return i("li",[i("span",[t._v(t._s(e-1))]),i("el-input",{attrs:{type:"textarea",autosize:{minRows:2}},on:{input:function(i){return t.changeCateJsonPic(e-1,i)}},model:{value:t.cate_json.pic_list.data[e-1],callback:function(i){t.$set(t.cate_json.pic_list.data,e-1,i)},expression:"cate_json.pic_list.data[i - 1]"}})],1)})):t._e()],2)])],1)],1):t._e()],1):t._e()],1)],1)],1),i("div",{staticClass:"dialog-footer"},[t.isedit?i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.sub_edit("form")}}},[t._v("修 改")]):i("el-button",{attrs:{type:"primary"},on:{click:t.sub}},[t._v("确 定")])],1)]:t._e()],2)])],1)],1)],1),i("Pic",{attrs:{drawer:t.drawer,father_fun:t.get_img,length:t.length}})],1)},o=[],n=(i("1bc78"),i("eec3"),i("9f60"),i("94f0"),i("0c84"),i("2843"),i("a450"),i("4057"),i("3f5b"),i("4890"),i("3441"),i("6a61"),i("2e91")),s=(i("085b"),i("196d")),l=i.n(s),r=i("f820"),c=i("15fc"),u=i("71c2"),d=i("a49b");function f(t,e){var i;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=m(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,l=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return s=t.done,t},e:function(t){l=!0,n=t},f:function(){try{s||null==i.return||i.return()}finally{if(l)throw n}}}}function m(t,e){if(t){if("string"===typeof t)return _(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}var p={name:"Category",components:{NavTo:c["a"],Header:u["a"],VueUeditorWrap:l.a,Pic:r["default"]},data:function(){return{ids:[],multipleSelection:[],is_hsz:0,radio:"1",isedit:!1,length:1,drawer:!1,getimg:this.$getimg,img_list:[],myConfig:{autoHeightEnabled:!1,wordCount:!1,maximumWords:1e6,initialFrameHeight:540,initialFrameWidth:"80%",serverUrl:d["a"]+"ue_uploads",UEDITOR_HOME_URL:"/cms/static/UEditor/",toolbars:[["justifyleft","justifycenter","justifyright","justifyjustify","bold","forecolor","fontsize","source","insertimage"]]},btn_name:"添加栏目",is_add:1,list:"",all:"",size:8,total:"",input:"",category:[],category_top:[],dialogTableVisible:!1,editbox:!1,editform:{category_name:"",short_name:"",pid:"",category_pic:""},formLabelWidth:"120px",editindex:0,form:{category_name:"",short_name:"",pid:"",category_pic:"",column_template_id:"",list_template_id:"",article_template_id:"",column_template:"",list_template:"",article_template:"",seotitle:"",keyword:"",seo_desc:"",type:"",jumpaddress:"",template:"",is_visible:1,level:1,sort:0,content:"",json:[]},pc_tmp:"",phone_tmp:"",activeName:"first",hsz_list:"",article_leve_h:[],cate_json:{},json_temp:""}},mounted:function(){this._load()},methods:{changeCateJsonCover:function(t,e){this.cate_json.cover.data[t]=e,this.$forceUpdate()},changeCateJsonArticle:function(t,e){this.cate_json.article_list.data[t]=e,this.$forceUpdate()},changeCateJsonPic:function(t,e){this.cate_json.pic_list.data[t]=e,this.$forceUpdate()},choose_json:function(t){var e=this.cate_json;for(var i in e)e[i].flag=!1;"cover"==t?e.cover["flag"]=!0:"article_list"==t?e.article_list["flag"]=!0:"pic_list"==t&&(e.pic_list["flag"]=!0),this.cate_json=e,console.log("co:",this.cate_json)},pl_del:function(){var t=this,e={id:{category:this.ids}};this.http.post("softDeletion/admin/del_trashedBatch",e).then((function(e){t.$message({message:"删除成功",type:"success"}),t.ids=[],t._load()}))},pl_hf:function(){var t=this,e={id:{category:this.ids}};this.http.post("softDeletion/admin/recovery_trashedBatch",e).then((function(e){t.$message({message:"恢复成功",type:"success"}),t.ids=[],t._load()}))},yj_del:function(){var t=this;this.$confirm("此操作将清空回收站, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.http.get("softDeletion/del_trashedAll").then((function(e){t.$message({type:"success",message:"删除成功!"}),t._load()}))}))},yj_hf:function(){var t=this;this.$confirm("此操作将恢复回收站所有文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.http.get("softDeletion/recovery").then((function(e){t.$message({type:"success",message:"恢复成功!"}),t._load()}))}))},choose:function(t){var e=this.ids.indexOf(t);console.log(e),e>=0?this.ids.splice(e,1):this.ids.push(t),console.log(this.ids)},handleSelectionChange:function(t){this.multipleSelection=t},_load:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this,this.http.get("softDeletion/admin/get_trashed").then((function(t){e.hsz_list=t.data.category})),this.getCategory(),t.next=5,this.http.get("common/template/get_pc_tep").then((function(t){if(t.data.tep){e.pc_tmp=t.data.tep,e.cate_json["cover"]={},e.cate_json.cover["flag"]=!1,e.cate_json.cover["data"]=[],e.cate_json["article_list"]={},e.cate_json.article_list["flag"]=!1,e.cate_json.article_list["data"]=[],e.cate_json["pic_list"]={},e.cate_json.pic_list["flag"]=!1,e.cate_json.pic_list["data"]=[];for(var i=0;i<t.data.tep.cover_num;i++)e.cate_json.cover.data[i]="";for(var a=0;a<t.data.tep.article_list_num;a++)e.cate_json.article_list.data[a]="";for(var o=0;o<t.data.tep.pic_list_num;o++)e.cate_json.pic_list.data[o]="";console.log(e.cate_json.article_list.data.length)}}));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),hsz:function(){this.is_hsz=1},sub:function(){var t=this;if(console.log("pid:",this.form.pid),0!=this.form.pid)for(var e in this.list)if(this.list[e].category_id==this.form.pid){this.form.level=this.list[e].level+1;break}for(var i in this.form.json=this.cate_json,this.cate_json)1==this.cate_json[i].flag&&(this.form.json=this.cate_json[i].data);console.log("level: ",this.form),this.http.post("category/admin/create_category",{form:this.form}).then((function(e){t.is_add=1,t.clear_data(),t.getCategory(),t.$message({message:"添加成功",type:"success"})}))},sub_edit:function(){var t=this,e={form:this.form};e.form.json=this.cate_json,this.http.post("category/admin/update_category",e).then((function(e){t.$message({message:"修改成功",type:"success"}),t.back(),t.getCategory()}))},add:function(){this.is_add=2,this.isedit=!1,this.is_hsz=0},back:function(){this.isedit=!1,this.is_add=1,this.is_hsz=0,this.form={category_name:"",short_name:"",pid:"",category_pic:"",column_template_id:"",list_template_id:"",article_template_id:"",column_template:"",list_template:"",article_template:"",seotitle:"",keyword:"",type:"",jumpaddress:""},this.img_list=[]},sort_sub:function(){var t,e=this,i={},a=this,o=f(a.category);try{for(o.s();!(t=o.n()).done;){var n=t.value;i[n.category_id]=n.sort}}catch(s){o.e(s)}finally{o.f()}this.http.post("category/admin/update_category_sort",i).then((function(){e.$message({message:"操作成功",type:"success"}),e.getCategory()}))},get_template:function(){var t=this;this.http.get("template/get_pc_template").then((function(e){t.pc_tmp=e.data})),this.http.get("template/get_phone_template").then((function(e){t.phone_tmp=e.data}))},getCategory:function(){var t=this,e=[];this.http.get("category/admin/get_category_all").then((function(i){t.article_leve_h=i.data.filter((function(t){return 1==t.level}));for(var a=0;a<i.data.length;a++)1==i.data[a].level&&e.push(i.data[a]),2==i.data[a].level?i.data[a].line=!0:i.data[a].line=!1;t.category=i.data,t.list=i.data}))},clear_data:function(){var t={category_name:"",short_name:"",pid:"",category_pic:"",column_template_id:"",list_template_id:"",article_template_id:"",column_template:"",list_template:"",article_template:"",seotitle:"",keyword:"",type:"",jumpaddress:""};this.img_list=[],this.form=t},del:function(t,e){var i=this,a=this;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.http.put("category/admin/delete_category",{id:t}).then((function(){return a.$message({showClose:!0,message:"删除成功",type:"success"}),a.category.splice(e,1),i._load(),!1}))}))},onedit:function(t){console.log(t),this.isedit=!0,this.is_add=2,this.form.category_pic=t.category_pic,this.form.category_name=t.category_name,this.form.short_name=t.short_name,this.form.pid=t.pid,this.form.column_template_id=t.column_template_id,this.form.list_template_id=t.list_template_id,this.form.article_template_id=t.article_template_id,this.form.list_template=t.list_template,this.form.column_template=t.column_template,this.form.article_template=t.article_template,this.form.seotitle=t.seotitle,this.form.keyword=t.keyword,this.form.type=t.type,this.form.category_id=t.category_id,t.jumpaddress&&(this.form.jumpaddress=t.jumpaddress),t.content&&(this.form.content=t.content),this.img_list.push({url:t.category_pic});var e=JSON.parse(t.json);if("cover"==t.type){this.cate_json.cover["flag"]=!0;for(var i=0;i<this.cate_json.cover.data.length;i++)this.cate_json.cover.data[i]=e.cover.data[i]}else if("article_list"==t.type){this.cate_json.article_list["flag"]=!0;for(var a=0;a<this.cate_json.article_list.data.length;a++)this.cate_json.article_list.data[a]=e.article_list.data[a]}else if("pic_list"==t.type){this.cate_json.pic_list["flag"]=!0;for(var o=0;o<this.cate_json.pic_list.data.length;o++)this.cate_json.pic_list.data[o]=e.pic_list.data[o]}},up_list:function(){this.getCategory()},onSubmit:function(t){var e=this,i=this;this.http.post("/admin/update_category",{form:i.editform}).then((function(a){console.log(a.data),i.editbox=!1,e.category.splice(t,1,a.data)}))},onswitch:function(t){var e=this;console.log(t),this.http.put("admin/onOff",{id:t,db:"category",field:"is_visible"}).then((function(t){console.log(t),e.$message({type:"success",message:"操作成功"})}))},onindex:function(t,e){var i=this,a="";"pc"==e?a="is_pc_index":"ph"==e&&(a="is_phone_index"),this.http.put("admin/onOff",{id:t,db:"category",field:a}).then((function(t){console.log(t),i.$message({type:"success",message:"操作成功"})}))},up_ok:function(t){201==t.code&&(this.editform.category_pic=t.id)},to_choose_img:function(){this.drawer=!this.drawer},is_show:function(){this.drawer=!this.drawer},get_img:function(t){for(var e in this.drawer=!1,t){var i=t[e];this.img_list.push(i),this.form.category_pic=i.url}this.length=6-this.img_list.length,console.log("get_img_end:",t,this.img_list),console.log(this.form)},delimg:function(t){this.img_list.splice(t,1)},handleClick:function(){console.log(this.activeName)}}},h=p,g=(i("30a7"),i("5d22")),b=Object(g["a"])(h,a,o,!1,null,"00bde440",null);e["default"]=b.exports},"3c56":function(t,e,i){var a=i("93ca"),o=i("0c29"),n=i("35d4");t.exports=function(t){var e=a(t),i=o.f;if(i){var s,l=i(t),r=n.f,c=0;while(l.length>c)r.call(t,s=l[c++])&&e.push(s)}return e}},4441:function(t,e,i){var a=i("3471"),o=i("21d9").f,n={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],l=function(t){try{return o(t)}catch(e){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==n.call(t)?l(t):o(a(t))}},4583:function(t,e,i){},5795:function(t,e,i){"use strict";i("3733")},"94f0":function(t,e,i){"use strict";var a=i("0b34"),o=i("4fd4"),n=i("26df"),s=i("e99b"),l=i("84e8"),r=i("49f2").KEY,c=i("0926"),u=i("baa7"),d=i("bac3"),f=i("d8b3"),m=i("839a"),_=i("1a58"),p=i("078c"),h=i("3c56"),g=i("d1cb"),b=i("a86f"),v=i("9cff"),y=i("8078"),w=i("3471"),k=i("5d10"),x=i("5edc"),j=i("7ee3"),S=i("4441"),C=i("285b"),$=i("0c29"),O=i("bb8b"),z=i("93ca"),F=C.f,L=O.f,E=S.f,N=a.Symbol,P=a.JSON,D=P&&P.stringify,T="prototype",A=m("_hidden"),J=m("toPrimitive"),B={}.propertyIsEnumerable,V=u("symbol-registry"),I=u("symbols"),W=u("op-symbols"),U=Object[T],R="function"==typeof N&&!!$.f,H=a.QObject,M=!H||!H[T]||!H[T].findChild,G=n&&c((function(){return 7!=j(L({},"a",{get:function(){return L(this,"a",{value:7}).a}})).a}))?function(t,e,i){var a=F(U,e);a&&delete U[e],L(t,e,i),a&&t!==U&&L(U,e,a)}:L,K=function(t){var e=I[t]=j(N[T]);return e._k=t,e},Q=R&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,e,i){return t===U&&Y(W,e,i),b(t),e=k(e,!0),b(i),o(I,e)?(i.enumerable?(o(t,A)&&t[A][e]&&(t[A][e]=!1),i=j(i,{enumerable:x(0,!1)})):(o(t,A)||L(t,A,x(1,{})),t[A][e]=!0),G(t,e,i)):L(t,e,i)},q=function(t,e){b(t);var i,a=h(e=w(e)),o=0,n=a.length;while(n>o)Y(t,i=a[o++],e[i]);return t},X=function(t,e){return void 0===e?j(t):q(j(t),e)},Z=function(t){var e=B.call(this,t=k(t,!0));return!(this===U&&o(I,t)&&!o(W,t))&&(!(e||!o(this,t)||!o(I,t)||o(this,A)&&this[A][t])||e)},tt=function(t,e){if(t=w(t),e=k(e,!0),t!==U||!o(I,e)||o(W,e)){var i=F(t,e);return!i||!o(I,e)||o(t,A)&&t[A][e]||(i.enumerable=!0),i}},et=function(t){var e,i=E(w(t)),a=[],n=0;while(i.length>n)o(I,e=i[n++])||e==A||e==r||a.push(e);return a},it=function(t){var e,i=t===U,a=E(i?W:w(t)),n=[],s=0;while(a.length>s)!o(I,e=a[s++])||i&&!o(U,e)||n.push(I[e]);return n};R||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(i){this===U&&e.call(W,i),o(this,A)&&o(this[A],t)&&(this[A][t]=!1),G(this,t,x(1,i))};return n&&M&&G(U,t,{configurable:!0,set:e}),K(t)},l(N[T],"toString",(function(){return this._k})),C.f=tt,O.f=Y,i("21d9").f=S.f=et,i("35d4").f=Z,$.f=it,n&&!i("3d8a")&&l(U,"propertyIsEnumerable",Z,!0),_.f=function(t){return K(m(t))}),s(s.G+s.W+s.F*!R,{Symbol:N});for(var at="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ot=0;at.length>ot;)m(at[ot++]);for(var nt=z(m.store),st=0;nt.length>st;)p(nt[st++]);s(s.S+s.F*!R,"Symbol",{for:function(t){return o(V,t+="")?V[t]:V[t]=N(t)},keyFor:function(t){if(!Q(t))throw TypeError(t+" is not a symbol!");for(var e in V)if(V[e]===t)return e},useSetter:function(){M=!0},useSimple:function(){M=!1}}),s(s.S+s.F*!R,"Object",{create:X,defineProperty:Y,defineProperties:q,getOwnPropertyDescriptor:tt,getOwnPropertyNames:et,getOwnPropertySymbols:it});var lt=c((function(){$.f(1)}));s(s.S+s.F*lt,"Object",{getOwnPropertySymbols:function(t){return $.f(y(t))}}),P&&s(s.S+s.F*(!R||c((function(){var t=N();return"[null]"!=D([t])||"{}"!=D({a:t})||"{}"!=D(Object(t))}))),"JSON",{stringify:function(t){var e,i,a=[t],o=1;while(arguments.length>o)a.push(arguments[o++]);if(i=e=a[1],(v(e)||void 0!==t)&&!Q(t))return g(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!Q(e))return e}),a[1]=e,D.apply(P,a)}}),N[T][J]||i("065d")(N[T],J,N[T].valueOf),d(N,"Symbol"),d(Math,"Math",!0),d(a.JSON,"JSON",!0)},"9f60":function(t,e,i){i("078c")("asyncIterator")},a450:function(t,e,i){var a=i("bb8b").f,o=Function.prototype,n=/^\s*function ([^ (]*)/,s="name";s in o||i("26df")&&a(o,s,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})},eec3:function(t,e,i){var a=i("e99b");a(a.S,"Array",{isArray:i("d1cb")})},f820:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"about"},[i("el-drawer",{attrs:{title:"图库管理",visible:t.drawer,direction:"rtl",size:"35%","before-close":t.close_box},on:{"update:visible":function(e){t.drawer=e}}},[i("span",[i("div",{staticClass:"rltan"},[i("div",{staticClass:"btn"},[i("el-button",{on:{click:function(e){t.dialogVisibleadd=!0}}},[t._v("添加")])],1),i("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.category_nav},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"全部",name:"0"}}),t._l(t.img_category,(function(t){return[i("el-tab-pane",{attrs:{label:t.category_name,name:t.id+""}})]}))],2),i("div",{staticClass:"con"},[i("el-upload",{attrs:{action:t.upfile_url,data:{cid:t.cate_id,back:"idurl"},"on-success":t.upimg_back_fun,headers:t.upfile_head,limit:9,multiple:"","show-file-list":!1,"file-list":t.upfile_banner_list,name:"img","list-type":"picture-card"}},[i("i",{staticClass:"el-icon-plus"})]),i("el-dialog",{attrs:{visible:t.dialogVisiblea},on:{"update:visible":function(e){t.dialogVisiblea=e}}}),i("div",{staticStyle:{height:"25px"}}),i("el-row",{attrs:{gutter:18}},[0==t.cate_id?t._l(t.img_list,(function(e,a){return i("el-col",{key:a,attrs:{span:6}},[i("div",{class:t.tab_css(a)},[i("img",{staticClass:"img",attrs:{src:t.getimg+e.url},on:{click:function(e){return t.choose_img(a)}}})])])})):t._l(t.imgB,(function(e,a){return i("el-col",{key:a,staticClass:"abox",attrs:{span:6}},[i("div",{class:t.tab_css(a)},[i("img",{staticClass:"img",attrs:{src:t.getimg+e.url},on:{click:function(e){return t.choose_img(a)}}})])])}))],2),i("div",{staticStyle:{height:"300px"}})],1),i("div",{staticClass:"footbtn"},[i("el-button",{on:{click:t.close_box}},[t._v("取消")]),i("el-button",{attrs:{type:"warning"},on:{click:t.del_img}},[t._v("删除")]),i("el-button",{attrs:{type:"primary"},on:{click:t.add_img}},[t._v("确定")])],1)],1)])]),i("el-dialog",{attrs:{title:"添加图片分类",visible:t.dialogVisibleadd,width:"30%"},on:{"update:visible":function(e){t.dialogVisibleadd=e}}},[i("el-form",{ref:"cate_form",attrs:{model:t.cate_form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"分类名称"}},[i("el-input",{model:{value:t.cate_form.category_name,callback:function(e){t.$set(t.cate_form,"category_name",e)},expression:"cate_form.category_name"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogVisibleadd=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确 定")])],1)],1)],1)},o=[],n=(i("a450"),i("085b"),i("a49b")),s={data:function(){return{activeName:"first",form:{name:"",banner_imgs:""},dialogVisibleadd:!1,dialogVisiblea:!1,getimg:this.$getimg,cate_id:"0",cate_form:{category_name:""},img_category:"",img_list:[],checkList:[],add_img_list:[],upfile_url:n["a"]+"image/upload_img",upfile_head:{token:localStorage.getItem("token")},upfile_list:[],upfile_list_sku:[],upfile_banner_list:[]}},props:{drawer:"",length:"",ishead:"",father_fun:Function,iscg:""},components:{},mounted:function(){this._load(),this.checkList=[]},methods:{_load:function(){var t=this;this.http.get("image/get_img_all").then((function(e){t.img_list=e.data}))},onSubmit:function(){var t=this;this.http.post_show("img_category/admin/add_category",this.cate_form).then((function(e){t.$message({message:"添加成功",type:"success"}),t.dialogVisibleadd=!1,t._load()}))},change_del:function(){this.checkList=[],this.show_choose="",this.length=this.img_list.length},add_img:function(){console.log("start:",this.checkList,this.img_list,this.add_img_list);var t=this;for(var e in this.checkList){var i=this.checkList[e];for(var a in this.img_list)i==a&&t.add_img_list.push({id:this.img_list[a].id,url:this.img_list[a].url})}if(this.add_img_list.length<=this.length){var o=this.add_img_list;this.add_img_list=[],this.checkList=[],this.father_fun(o),this.drawer=!1}else this.$message({message:"最多选择"+this.length+"张图片",type:"warning"})},tab_css:function(t){return this.checkList.indexOf(t)>-1?"pic1":"pic"},choose_img:function(t){console.log("choose_img",t,this.length);var e=this;if(e.checkList.indexOf(t)>-1){var i=e.checkList.indexOf(t);e.checkList.splice(i,1)}else{if(!(e.checkList.length<e.length))return void this.$message({message:"最多选择"+this.length+"张图片",type:"warning"});e.checkList.push(t)}console.log(this.checkList)},del_img:function(){var t=this,e=[];for(var i in this.checkList){var a=this.checkList[i];for(var o in this.img_list)a==o&&e.push(this.img_list[o].id)}this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.http.del("image/del_img",{ids:e}).then((function(e){t.$message({type:"success",message:e.msg}),t.checkList=[],t._load()}))}))},upimg_back_fun:function(t){this.$message({type:"success",message:"上传成功"}),console.log(t),console.log(this.upfile_banner_list),this._load()},category_nav:function(t){this.cate_id=t.name;var e=[];for(var i in this.img_list){var a=this.img_list[i];a.category_id==t.name&&e.push(a)}this.imgB=e},close_box:function(){console.log("xxx"),this.add_img_list=[],this.checkList=[],this.add_img()}}},l=s,r=(i("5795"),i("5d22")),c=Object(r["a"])(l,a,o,!1,null,null,null);e["default"]=c.exports}}]);